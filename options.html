<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ChatFocus Settings</title>
  <link rel="stylesheet" href="ui-common.css">
  <style>
    body {
      padding: 0;
      margin: 0;
      min-height: 100vh;
      background: var(--cf-color-bg-secondary);
    }

    .options-container {
      max-width: 640px;
      margin: 0 auto;
      padding: var(--cf-space-3xl);
    }

    /* Header */
    .options-header {
      margin-bottom: var(--cf-space-3xl);
    }

    .options-title-row {
      display: flex;
      align-items: center;
      gap: var(--cf-space-md);
      margin-bottom: var(--cf-space-md);
    }

    .options-icon {
      width: 32px;
      height: 32px;
      background: var(--cf-color-accent);
      border-radius: var(--cf-radius-lg);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .options-icon svg {
      width: 18px;
      height: 18px;
      stroke: white;
      fill: none;
      stroke-width: 2;
    }

    .options-title {
      font-size: var(--cf-text-2xl);
      font-weight: 600;
      color: var(--cf-color-text-primary);
    }

    .options-subtitle {
      color: var(--cf-color-text-secondary);
      font-size: var(--cf-text-md);
      margin-left: 44px;
    }

    /* Main Card */
    .options-card {
      background: var(--cf-color-bg-primary);
      border: 1px solid var(--cf-color-border-base);
      border-radius: var(--cf-radius-xl);
      overflow: hidden;
    }

    /* Section */
    .options-section {
      padding: var(--cf-space-2xl);
      border-bottom: 1px solid var(--cf-color-border-base);
    }

    .options-section:last-child {
      border-bottom: none;
    }

    .options-section-title {
      font-size: var(--cf-text-lg);
      font-weight: 600;
      color: var(--cf-color-text-primary);
      margin-bottom: var(--cf-space-md);
    }

    /* Setting Row */
    .setting-row {
      margin-bottom: var(--cf-space-2xl);
    }

    .setting-row:last-child {
      margin-bottom: 0;
    }

    .setting-header {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: var(--cf-space-lg);
      margin-bottom: var(--cf-space-sm);
    }

    .setting-info {
      flex: 1;
    }

    .setting-label {
      font-size: var(--cf-text-md);
      font-weight: 500;
      color: var(--cf-color-text-primary);
      margin-bottom: var(--cf-space-xs);
      display: block;
    }

    .setting-description {
      font-size: var(--cf-text-sm);
      color: var(--cf-color-text-secondary);
      line-height: 1.5;
    }

    .setting-control {
      flex-shrink: 0;
    }

    /* Range Input Row */
    .range-row {
      display: flex;
      align-items: center;
      gap: var(--cf-space-lg);
      margin-top: var(--cf-space-md);
    }

    .range-input-wrapper {
      flex: 1;
    }

    .range-value-display {
      font-size: var(--cf-text-md);
      font-weight: 600;
      color: var(--cf-color-accent);
      min-width: 32px;
      text-align: right;
    }

    /* Number Input */
    .number-input-wrapper {
      margin-top: var(--cf-space-md);
      max-width: 200px;
    }

    /* Action Buttons */
    .options-actions {
      padding: var(--cf-space-2xl);
      background: var(--cf-color-bg-secondary);
      display: flex;
      gap: var(--cf-space-md);
    }

    /* Status Message */
    .options-status {
      margin-top: var(--cf-space-lg);
      padding: var(--cf-space-md) var(--cf-space-lg);
      border-radius: var(--cf-radius-lg);
      font-size: var(--cf-text-base);
      text-align: center;
      opacity: 0;
      pointer-events: none;
      transition: opacity var(--cf-duration-base) ease;
    }

    .options-status.success {
      opacity: 1;
      background: var(--cf-color-success-bg);
      color: var(--cf-color-success);
    }

    .options-status.error {
      opacity: 1;
      background: var(--cf-color-error-bg);
      color: var(--cf-color-error);
    }

    /* Shortcuts Table */
    .shortcuts-table {
      width: 100%;
    }

    .shortcut-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: var(--cf-space-md) 0;
      border-bottom: 1px solid var(--cf-color-border-light);
    }

    .shortcut-row:last-child {
      border-bottom: none;
    }

    .shortcut-description {
      font-size: var(--cf-text-base);
      color: var(--cf-color-text-primary);
    }

    .shortcut-keys {
      display: flex;
      gap: var(--cf-space-xs);
    }

    /* Platform-specific shortcuts */
    .platform-mac .shortcut-keys-win {
      display: none;
    }

    .platform-win .shortcut-keys-mac {
      display: none;
    }

    /* Info Box */
    .info-box {
      margin-top: var(--cf-space-2xl);
      padding: var(--cf-space-lg);
      background: var(--cf-color-bg-secondary);
      border-radius: var(--cf-radius-lg);
      border-left: 3px solid var(--cf-color-accent);
    }

    .info-box-title {
      font-size: var(--cf-text-md);
      font-weight: 600;
      color: var(--cf-color-text-primary);
      margin-bottom: var(--cf-space-sm);
    }

    .info-box-text {
      font-size: var(--cf-text-sm);
      color: var(--cf-color-text-secondary);
      line-height: 1.6;
    }
  </style>
</head>
<body>
  <div class="options-container">
    <!-- Header -->
    <div class="options-header">
      <div class="options-title-row">
        <div class="options-icon">
          <svg viewBox="0 0 24 24">
            <path d="M12 2L2 7l10 5 10-5-10-5z"/>
            <path d="M2 17l10 5 10-5"/>
            <path d="M2 12l10 5 10-5"/>
          </svg>
        </div>
        <h1 class="options-title">ChatFocus Settings</h1>
      </div>
      <p class="options-subtitle">Configure your focused chat experience</p>
    </div>

    <!-- Main Card -->
    <div class="options-card">
      <!-- General Settings -->
      <div class="options-section">
        <h2 class="options-section-title">General</h2>

        <!-- Enable Extension -->
        <div class="setting-row">
          <div class="setting-header">
            <div class="setting-info">
              <label class="setting-label" for="enabled">Enable Extension</label>
              <p class="setting-description">
                Toggle ChatFocus on or off. When disabled, all messages remain expanded.
              </p>
            </div>
            <div class="setting-control">
              <label class="cf-toggle">
                <input type="checkbox" id="enabled">
                <span class="cf-toggle-slider"></span>
              </label>
            </div>
          </div>
        </div>

        <!-- Keep Open Count -->
        <div class="setting-row">
          <div class="setting-info">
            <label class="setting-label" for="keepOpen">Messages to Keep Open</label>
            <p class="setting-description">
              Number of recent messages to keep expanded. Older messages will be automatically collapsed.
            </p>
          </div>
          <div class="range-row">
            <div class="range-input-wrapper">
              <input type="range" id="keepOpen" class="cf-range" min="1" max="5" value="1">
            </div>
            <span class="range-value-display" id="keepOpenValue">1</span>
          </div>
        </div>

        <!-- Preview Length -->
        <div class="setting-row">
          <div class="setting-info">
            <label class="setting-label" for="previewLength">Preview Text Length</label>
            <p class="setting-description">
              Maximum number of characters to show in collapsed message previews (30-200).
            </p>
          </div>
          <div class="number-input-wrapper">
            <input type="number" id="previewLength" class="cf-input" min="30" max="200" value="85">
          </div>
        </div>
      </div>

      <!-- Keyboard Shortcuts -->
      <div class="options-section">
        <h2 class="options-section-title">Keyboard Shortcuts</h2>

        <div class="shortcuts-table">
          <div class="shortcut-row">
            <span class="shortcut-description">Expand all messages</span>
            <div class="shortcut-keys shortcut-keys-win">
              <span class="cf-kbd">Ctrl</span>
              <span class="cf-kbd">Shift</span>
              <span class="cf-kbd">E</span>
            </div>
            <div class="shortcut-keys shortcut-keys-mac">
              <span class="cf-kbd">⌘</span>
              <span class="cf-kbd">⇧</span>
              <span class="cf-kbd">E</span>
            </div>
          </div>

          <div class="shortcut-row">
            <span class="shortcut-description">Collapse all messages</span>
            <div class="shortcut-keys shortcut-keys-win">
              <span class="cf-kbd">Ctrl</span>
              <span class="cf-kbd">Shift</span>
              <span class="cf-kbd">C</span>
            </div>
            <div class="shortcut-keys shortcut-keys-mac">
              <span class="cf-kbd">⌘</span>
              <span class="cf-kbd">⇧</span>
              <span class="cf-kbd">C</span>
            </div>
          </div>

          <div class="shortcut-row">
            <span class="shortcut-description">Toggle extension on/off</span>
            <div class="shortcut-keys shortcut-keys-win">
              <span class="cf-kbd">Ctrl</span>
              <span class="cf-kbd">Shift</span>
              <span class="cf-kbd">T</span>
            </div>
            <div class="shortcut-keys shortcut-keys-mac">
              <span class="cf-kbd">⌘</span>
              <span class="cf-kbd">⇧</span>
              <span class="cf-kbd">T</span>
            </div>
          </div>

          <div class="shortcut-row">
            <span class="shortcut-description">Toggle table of contents</span>
            <div class="shortcut-keys shortcut-keys-win">
              <span class="cf-kbd">Ctrl</span>
              <span class="cf-kbd">Shift</span>
              <span class="cf-kbd">O</span>
            </div>
            <div class="shortcut-keys shortcut-keys-mac">
              <span class="cf-kbd">⌘</span>
              <span class="cf-kbd">⇧</span>
              <span class="cf-kbd">O</span>
            </div>
          </div>
        </div>

        <div class="info-box">
          <div class="info-box-title">Pro Tip</div>
          <div class="info-box-text">
            Click the floating controls at the bottom-right of ChatGPT to quickly expand/collapse all messages, toggle code-only mode, or open the table of contents. You can drag the controls to reposition them.
          </div>
        </div>
      </div>

      <!-- Actions -->
      <div class="options-actions">
        <button class="cf-btn cf-btn-primary cf-btn-full" id="saveButton">
          Save Settings
        </button>
        <button class="cf-btn cf-btn-ghost" id="resetButton">
          Reset to Defaults
        </button>
      </div>
    </div>

    <!-- Status Message -->
    <div class="options-status" id="statusMessage"></div>
  </div>

  <script>
    // Detect platform for keyboard shortcuts display
    const isMac = navigator.platform.toUpperCase().indexOf('MAC') >= 0;
    document.body.classList.add(isMac ? 'platform-mac' : 'platform-win');
  </script>
  <script src="options.js"></script>
</body>
</html>
